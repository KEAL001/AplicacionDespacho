<!-- ConsultasReportesWindow.xaml - CÓDIGO COMPLETO ACTUALIZADO -->  
<Window x:Class="AplicacionDespacho.ConsultasReportesWindow"    
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"    
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"    
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"    
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"    
        mc:Ignorable="d"    
        Title="Consultas y Reportes de Viajes" Height="700" Width="1200"    
        ResizeMode="CanResize"    
        WindowStartupLocation="CenterScreen"    
        Loaded="Window_Loaded">  
  
    <Grid Margin="20">  
        <Grid.RowDefinitions>  
            <RowDefinition Height="Auto"/>  
            <RowDefinition Height="Auto"/>  
            <RowDefinition Height="*"/>  
            <RowDefinition Height="Auto"/>  
        </Grid.RowDefinitions>  
  
        <!-- Título -->  
        <TextBlock Grid.Row="0" Text="Consultas y Reportes de Viajes"     
                   FontSize="18" FontWeight="Bold"     
                   HorizontalAlignment="Center" Margin="0,0,0,20"/>  
  
        <!-- Panel de filtros ACTUALIZADO -->  
        <GroupBox Grid.Row="1" Header="Filtros de Búsqueda" Margin="0,0,0,20">  
            <Grid Margin="10">  
                <Grid.RowDefinitions>  
                    <RowDefinition Height="Auto"/>  
                    <RowDefinition Height="Auto"/>  
                    <RowDefinition Height="Auto"/>  
                    <RowDefinition Height="Auto"/>  
                </Grid.RowDefinitions>  
                <Grid.ColumnDefinitions>  
                    <ColumnDefinition Width="Auto"/>  
                    <ColumnDefinition Width="*"/>  
                    <ColumnDefinition Width="Auto"/>  
                    <ColumnDefinition Width="*"/>  
                    <ColumnDefinition Width="Auto"/>  
                </Grid.ColumnDefinitions>  
  
                <!-- Búsqueda por número de guía -->  
                <Label Grid.Row="0" Grid.Column="0" Content="Número de Guía:"     
                       VerticalAlignment="Center" Margin="0,0,10,0"/>  
                <TextBox x:Name="txtNumeroGuia" Grid.Row="0" Grid.Column="1"     
                         Margin="0,0,20,5" Height="25" VerticalAlignment="Center"/>  
  
                <!-- NUEVO: Búsqueda por número de pallet -->  
                <Label Grid.Row="0" Grid.Column="2" Content="N° Pallet:"     
                       VerticalAlignment="Center" Margin="0,0,10,0"/>  
                <TextBox x:Name="txtNumeroPallet" Grid.Row="0" Grid.Column="3"     
                         Margin="0,0,20,5" Height="25" VerticalAlignment="Center"/>  
  
                <!-- Filtro por empresa -->  
                <Label Grid.Row="1" Grid.Column="0" Content="Empresa:"     
                       VerticalAlignment="Center" Margin="0,0,10,0"/>  
                <ComboBox x:Name="cmbEmpresa" Grid.Row="1" Grid.Column="1"     
                          Margin="0,0,20,5" Height="25" VerticalAlignment="Center"    
                          SelectionChanged="cmbEmpresa_SelectionChanged"/>  
  
                <!-- Filtro por conductor -->  
                <Label Grid.Row="1" Grid.Column="2" Content="Conductor:"     
                       VerticalAlignment="Center" Margin="0,0,10,0"/>  
                <ComboBox x:Name="cmbConductor" Grid.Row="1" Grid.Column="3"     
                          Margin="0,0,20,5" Height="25" VerticalAlignment="Center"/>  
  
                <!-- Filtro por fechas -->  
                <Label Grid.Row="2" Grid.Column="0" Content="Fecha Desde:"     
                       VerticalAlignment="Center" Margin="0,0,10,0"/>  
                <DatePicker x:Name="dpFechaDesde" Grid.Row="2" Grid.Column="1"     
                            Margin="0,0,20,5" Height="25" VerticalAlignment="Center"/>  
  
                <Label Grid.Row="2" Grid.Column="2" Content="Fecha Hasta:"     
                       VerticalAlignment="Center" Margin="0,0,10,0"/>  
                <DatePicker x:Name="dpFechaHasta" Grid.Row="2" Grid.Column="3"     
                            Margin="0,0,0,5" Height="25" VerticalAlignment="Center"/>  
  
                <!-- Botones de acción -->  
                <StackPanel Grid.Row="3" Grid.Column="4" Orientation="Horizontal"     
                           VerticalAlignment="Center" Margin="20,10,0,0">  
                    <Button x:Name="btnBuscar" Content="Buscar" Width="80" Height="25"     
                            Margin="0,0,10,0" Click="btnBuscar_Click"/>  
                    <Button x:Name="btnLimpiar" Content="Limpiar" Width="80" Height="25"     
                            Click="btnLimpiar_Click"/>  
                </StackPanel>  
            </Grid>  
        </GroupBox>  
  
        <!-- Resultados de búsqueda -->  
        <GroupBox Grid.Row="2" Header="Resultados de Búsqueda" Margin="0,0,0,20">  
            <DataGrid x:Name="dgResultados"     
                      AutoGenerateColumns="False"     
                      CanUserAddRows="False"    
                      CanUserDeleteRows="False"    
                      SelectionMode="Single"    
                      GridLinesVisibility="Horizontal"    
                      AlternatingRowBackground="LightGray"    
                      HeadersVisibility="Column"    
                      IsReadOnly="True"    
                      SelectionChanged="dgResultados_SelectionChanged">  
                <DataGrid.Columns>  
                    <DataGridTextColumn Header="ID Viaje" Binding="{Binding ViajeId}" Width="80"/>  
                    <DataGridTextColumn Header="Fecha" Binding="{Binding Fecha, StringFormat=dd/MM/yyyy}" Width="100"/>  
                    <DataGridTextColumn Header="N° Viaje" Binding="{Binding NumeroViaje}" Width="80"/>  
                    <DataGridTextColumn Header="N° Guía" Binding="{Binding NumeroGuia}" Width="120"/>  
                    <DataGridTextColumn Header="Responsable" Binding="{Binding Responsable}" Width="150"/>  
                    <DataGridTextColumn Header="Empresa" Binding="{Binding NombreEmpresa}" Width="200"/>  
                    <DataGridTextColumn Header="Conductor" Binding="{Binding NombreConductor}" Width="150"/>  
                    <DataGridTextColumn Header="Placa" Binding="{Binding PlacaVehiculo}" Width="100"/>  
                    <DataGridTextColumn Header="Estado" Binding="{Binding Estado}" Width="80"/>  
                </DataGrid.Columns>  
            </DataGrid>  
        </GroupBox>  
  
        <!-- Botones de reportes -->  
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right">  
            <Button x:Name="btnGenerarReporte" Content="Generar Reporte" Width="120" Height="30"     
                    Margin="0,0,10,0" Click="btnGenerarReporte_Click"/>  
            <Button x:Name="btnImprimirDespacho" Content="Imprimir Despacho" Width="120" Height="30"     
                    Margin="0,0,10,0" Click="btnImprimirDespacho_Click"/>  
            <Button x:Name="btnCerrar" Content="Cerrar" Width="80" Height="30"     
                    Click="btnCerrar_Click"/>  
        </StackPanel>  
    </Grid>  
</Window>