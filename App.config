<?xml version="1.0" encoding="utf-8"?>
<configuration>
	<!-- ✅ PASO 1: configSections DEBE ser el PRIMER elemento -->
	<configSections>
		<section name="nlog" type="NLog.Config.ConfigSectionHandler, NLog"/>
	</configSections>

	<!-- ✅ PASO 2: Cadenas de conexión -->
	<connectionStrings>
		<add name="PackingSJP"
			 connectionString="Data Source=DESKTOP-18ERN8F\SQLEXPRESS;Initial Catalog=Packing_SJP;Integrated Security=True;Connection Timeout=30;"
			 providerName="System.Data.SqlClient" />
		<add name="DespachosSJP"
			 connectionString="Data Source=DESKTOP-18ERN8F\SQLEXPRESS;Initial Catalog=Despachos_SJP;Integrated Security=True;Connection Timeout=30;"
			 providerName="System.Data.SqlClient" />
	</connectionStrings>

	<!-- ✅ PASO 3: Configuraciones de la aplicación (sin duplicados) -->
	<appSettings>
		<!-- Configuraciones de la aplicación -->
		<add key="MaxPalletsPerTrip" value="100" />
		<add key="DefaultGuidePrefix" value="T004-" />
		<add key="DefaultResponsible" value="MIRTHA CASTRO" />
		<add key="DefaultDeparturePoint" value="PIURA" />
		<add key="DefaultArrivalPoint" value="SULLANA" />

		<!-- Configuraciones de logging -->
		<add key="LogLevel" value="Info" />
		<add key="LogFilePath" value="Logs\AplicacionDespacho.log" />
		<add key="EnableFileLogging" value="true" />

		<!-- Configuraciones de UI -->
		<add key="DataGridPageSize" value="100" />
		<add key="AutoSaveInterval" value="300" />
		<add key="ShowDebugInfo" value="false" />
	</appSettings>

	<!-- ✅ PASO 4: Configuración de NLog -->
	<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
		  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

		<targets>
			<!-- Archivo de log principal -->
			<target xsi:type="File" name="fileTarget"
					fileName="Logs/AplicacionDespacho-${shortdate}.log"
					layout="${longdate} ${uppercase:${level}} ${logger} ${message} ${exception:format=tostring}"
					archiveFileName="Logs/Archive/AplicacionDespacho-{#}.log"
					archiveEvery="Day"
					archiveNumbering="Rolling"
					maxArchiveFiles="30" />

			<!-- Archivo separado para errores críticos -->
			<target xsi:type="File" name="errorTarget"
					fileName="Logs/Errors/AplicacionDespacho-Errors-${shortdate}.log"
					layout="${longdate} ${uppercase:${level}} ${logger} ${message} ${exception:format=tostring}"
					archiveFileName="Logs/Errors/Archive/AplicacionDespacho-Errors-{#}.log"
					archiveEvery="Day"
					maxArchiveFiles="90" />

			<!-- Consola para desarrollo -->
			<target xsi:type="Console" name="consoleTarget"
					layout="${time} ${uppercase:${level}} ${message}" />
		</targets>

		<rules>
			<logger name="*" minlevel="Error" writeTo="errorTarget" />
			<logger name="*" minlevel="Info" writeTo="fileTarget" />
			<logger name="*" minlevel="Debug" writeTo="consoleTarget" />
		</rules>
	</nlog>

</configuration>